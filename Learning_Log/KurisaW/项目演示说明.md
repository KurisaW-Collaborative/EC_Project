## G4

* 蓝牙指令控制（运动方向控制、车速调节）
* 获取当前编码器数值，解析为车速度：定时器根据电机的霍尔编码器获取到的脉冲值，解析为速度值，通过PID对速度进行限幅
* AT Client接收TCP服务端信息

## F4

异常环境：

* 空气质量监测（设为6个等级，最大等级会触发报警任务--->异常监测--->TCP客户端（F4）发送消息给G4服务端）
* 噪声监测（通过高低电平触发频率来判断当前声贝值，使用高通滤波和低通滤波算法都不好使，方差查看系统的拟合程度也不好使）

气象数据采集

* 温湿度、光照、气压（数据采集、上报云端）

GPS数据上报（数据采集，上报云端）

语音交互

## H7

UI触发（正常UI显示）

火灾识别模型（识别火灾发生的特征值）

## ESP32CAM

外网摄像流监控

* 星空内网穿透+FRPC

---

## 演示

**巡防车底层运动逻辑测试**

* 基础运动控制测试（远程蓝牙APP控制）+ 终端数据查看
* PID限速测试 + 编码器测速 + 终端数据查看
* MPU9250姿态传感器测试 + 串口示波器查看

**数据采集任务**

* 温度、湿度、光照、气压、GPS模块驱动
* ...模块数据采集

**异常城市环境监测**

* 噪声监测
* PM值监测

**云平台数据查看**

* 数据上报Onenet云平台
* 云端UI查看：气象数据状态、GPS地图信息
* 云端命令下发：开启气象数据采集任务，本地F4接收

**语音交互**

```
posture,        // 0.车身姿态异常提示
fire_level1,    // 1.火警 Level1
fire_level2,    // 2.火警 Level2
weather_fin,    // 3.气象数据调出完成，语音提示成功
monitor_fin,    // 4.城市异常监测数据调出完成，语音提示成功
low_battery     // 5.电量低提示
```

**UI交互**

* 主界面UI：当前时间...
* 触发UI：气象数据查看、异常监测信息查看
* 车载信息UI

**火灾识别监测**

* 摄像头获取帧画面
* AI推理给出特征值估计
* UI显示对象信息

**网络摄像头**

* 摄像头驱动
* 内网穿透

**三端通讯**

每一块开发板都有独立的系统，并且通过TCP进行各个系统间的通讯。

（开启服务端--->客户端通过指定端口和IP连接服务端，并发送通知---->服务端进行接收，执行相应的逻辑）

>目前存在的问题：
>
>1.暂时完成部分，基本逻辑大致相似
>2.由于AT指令的响应时间可能导致服务端错过消息，客户端需要加入重确认机制
>3.服务端需要提前设定好来自客户端的通知格式，可以想办法保留每个已连接的客户端ID，并且可以设定一个通讯格式，以此在服务端能够对消息的数据帧格式进行判断再解析，从而直接获取到来自客户端发送的消息
>4.多个数据流的转发和接收

* G4--->F4：语音命令，姿态异常播报（√）
* H7--->F4：语音命令，火灾警告
* F4--->H7：语音命令，查看本地气象数据，H7调出气象数据UI    H7--->F4：调出UI后，发送标志位，语音触发已完成任务（√）
* G4--->H7：姿态异常，显示警示UI                                                H7--->F4：调出UI后，发送标志位，语音触发已完成任务（√）
* F4--->H7：异常监测数据（噪声、PM值），显示警示UI
